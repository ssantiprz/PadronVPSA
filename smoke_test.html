<!DOCTYPE html>
<html lang="es">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Smoke Test CSV</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; background:#0f172a; color:#fff; }
  .bar { padding:14px 16px; font-weight:800; }
  .info { background:#1f2937; }
  .ok { background:#059669; }
  .err { background:#dc2626; }
  .small { font-weight:400; opacity:.9; }
  pre { background:#111827; padding:12px; overflow:auto; }
</style>
<body>
  <div id="status" class="bar info">Cargando…</div>
  <div class="bar info small">CSV URL: <span id="url"></span></div>
  <pre id="out">Esperando respuesta…</pre>

<script>
const CSV_URL = new URL('padron.csv', location.href).href;
document.getElementById('url').textContent = CSV_URL;

function set(cls, msg){
  const s = document.getElementById('status');
  s.className = 'bar ' + cls;
  s.textContent = msg;
}

async function go(){
  try{
    set('info', 'Cargando…');
    const attempted = CSV_URL + (CSV_URL.includes('?') ? '&' : '?') + 't=' + Date.now();
    const r = await fetch(attempted, {cache:'no-store'});
    if (!r.ok) throw new Error('HTTP ' + r.status);
    const text = await r.text();
    set('ok', 'OK: Datos cargados (' + new Date().toLocaleString() + ')');
    document.getElementById('out').textContent = text.slice(0, 500) + (text.length>500?'\n…':''); // show first 500 chars
  }catch(e){
    set('err', 'ERROR: ' + e.message);
    document.getElementById('out').textContent = (e.stack || e.message);
  }
}

go();
</script>
</body>
</html>
